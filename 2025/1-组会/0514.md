# HCRNet: Hybrid Cross-modal Reconstruction Network

## 模型概述
HCRNet是一个面向光学与SAR影像协同处理的多模态融合网络，核心创新在于**频域-空域联合特征交互**与**动态自适应机制**。模型通过相位对齐、跨模态频谱单元、超网络动态卷积等模块，实现鲁棒的特征融合与重建。

## 关键模块

### 1. 相位相关对齐（PhaseCorrelationAlign）
- **可微分对齐**：基于FFT互功率谱计算偏移量，通过soft-argmax近似最大响应坐标
- **循环偏移补偿**：智能处理周期性边界条件，自动校正跨周期偏移（如256→-1）
- **向量化实现**：批处理优化，避免逐样本循环

### 2. 跨模态频谱单元（CrossModalFourierUnit）
- **频域特征交互**：将两模态特征转换到频域，分解实虚部分进行联合学习
- **多尺度对齐**：通过下采样对齐减少计算量，上采样恢复分辨率
- **复数卷积重构**：采用1x1卷积隐式学习频域特征关系

### 3. 动态超网络卷积（HyperCondConv2d）
- **权重动态生成**：基于多尺度特征通过超网络预测卷积核参数
- **约束优化**：tanh+α限制权重变化范围，提升训练稳定性
- **分组扩展**：支持多组卷积并行计算，保持参数效率

### 4. 混合特征阶段（HybridStage）
- **双通路融合**：
  - **局部通路**：FMBConv（动态卷积+CBAM注意力）捕获空域特征
  - **频域通路**：跨模态频谱单元建立频域关联
- **自适应加权**：可学习权重平衡局部与频域特征贡献

### 5. 不确定性引导融合（SimpleCrossModalFusion）
- **置信度估计**：双分支不确定性头生成像素级置信图
- **三重融合机制**：门控特征×SAR置信度 + 交叉注意力×联合置信 + 原始特征×光学置信度

## 创新亮点
1. **频域-空域协同**：首次在跨模态任务中联合优化频域对齐与空域卷积
2. **动态-静态耦合**：通过Hyper-CondConv实现静态架构中的动态参数适应
3. **不确定性融合**：引入可学习的置信度权重，提升噪声鲁棒性
4. **循环偏移补偿**：改进传统相位相关方法在深度学习中的边界处理

# 本科毕设的预测文件调试。
