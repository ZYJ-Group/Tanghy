## 迁移学习的准备工作

### 读取小样本数据
1、增加了一个lsDataset的读取数据集方式
2、去除预处理
3、新建image1、loss.txt、test.
4、修改一下config文件
5、RGB通道口修改一下
6、循环的地方输出修改一下
7、跑的显卡从0卡换到1卡

您对深度学习的基本过程的理解是正确的：将输入（如图片）送入网络，网络会产生输出，然后将输出与真实值进行比较，通过计算损失值来评估网络的表现。根据损失值通过反向传播算法调整网络参数，以期改善网络的表现。

对于您提到的去云任务，如果您希望网络在一开始就能输出与原始含云图像相似的结果，并逐渐学习去除云层以接近无云的真实图像，您可以考虑以下几个策略：

1. 从含云图像作为初始基准开始
您可以将网络设计成在一开始就尽量保留输入图像的原始特征，然后逐渐地学习如何去除云层。这可以通过以下几种方法实现：

恒等损失（Identity Loss）：在损失函数中加入一个项，鼓励网络输出与输入图像在没有去云操作的情况下尽可能相似。这可以帮助网络在初期阶段保持对输入图像的忠实度，而后逐渐学习去云的特征。

残差学习（Residual Learning）：设计网络以学习输入图像与无云图像之间的残差（即云层部分）。网络的输出将是对云层的预测，然后从输入图像中减去这个预测来得到去云图像。这种方法自然地保留了输入图像的大部分内容，只专注于去除云层。

2. 预训练与微调
使用预训练模型作为起点，然后在您的去云任务上进行微调：

预训练模型：如果有可用的，您可以从一个在类似任务上预训练过的模型开始。例如，如果有在类似环境或条件下进行去云任务的预训练模型，您可以使用这些模型作为起点，这样模型就不是从零开始学习。

微调：在预训练模型的基础上，用您的去云数据集进行微调。在微调过程中，模型将会根据您的特定数据进一步调整其参数，从而学习去除云层。

3. 注意力机制
考虑在网络中引入注意力机制，使网络能够专注于图像中含云的区域。通过这种方式，网络可以更有效地学习如何处理这些区域，同时保持其他区域的原貌。

4. 迁移学习与领域适应
如果您的网络在一个领域（如无云图像）上已经有了很好的性能，但在另一个领域（如含云图像）上表现不佳，您可以考虑使用迁移学习或领域适应技术来调整网络，使其更好地泛化到新的领域。

总的来说，通过这些策略，您可以使网络在一开始就输出与原始含云图像相似的结果，并逐步学习去除云层，而不是完全从零开始生成去云图像。这些方法可以帮助网络更快地收敛，同时提高去云效果的自然性和真实性。
# 图像质量评估指标

## 1. PSNR (峰值信噪比 Peak Signal-to-Noise Ratio)

### 意义
PSNR是最常用的衡量图像重建或去噪质量的指标之一。它衡量的是原始图像与处理后图像之间的相似度。PSNR值越高，表明图像质量越好。

### 公式

$$
PSNR = 10 \cdot \log_{10} \left( \frac{MAX_I^2}{MSE} \right)
$$

其中， $MAX_I$是图像可能的最大像素值（对于8位图像， $MAX_I=255$）， $MSE$是均方误差，计算如下：

$$
MSE = \frac{1}{mn} \sum_{i=0}^{m-1} \sum_{j=0}^{n-1} \left[ I(i, j) - K(i, j) \right]^2
$$

 $I$是原始图像， $K$是处理后的图像， $m$和 $n$分别是图像的行数和列数。

## 2. SSIM (结构相似性指数 Structural Similarity Index)

### 意义
SSIM是一个更为先进的衡量图像质量的指标，与PSNR不同，SSIM考虑了图像的结构信息、亮度和对比度。SSIM值越接近1，表示图像质量越好。

### 公式

$$
SSIM(x, y) = \frac{(2\mu_x\mu_y + C_1)(2\sigma_{xy} + C_2)}{(\mu_x^2 + \mu_y^2 + C_1)(\sigma_x^2 + \sigma_y^2 + C_2)}
$$

其中， $\mu_x, \mu_y$是 $x, y$图像的平均亮度， $\sigma_x^2, \sigma_y^2$是图像的方差， $\sigma_{xy}$是 $x$和 $y$图像的协方差， $C_1$和 $C_2$是为了避免分母为零而添加的小常数。

## 3. MAE (平均绝对误差 Mean Absolute Error)

### 意义
MAE衡量的是原始图像与处理后图像之间的平均绝对差异。MAE值越低，说明图像质量越接近原始图像。

### 公式

$$
MAE = \frac{1}{mn} \sum_{i=0}^{m-1} \sum_{j=0}^{n-1} | I(i, j) - K(i, j) |
$$

## 4. SAM (光谱角映射器 Spectral Angle Mapper)

### 意义
SAM是遥感图像分析中常用的一个指标，它主要用于衡量两个光谱之间的相似度。SAM计算的是两个光谱向量之间的角度，角度越小，表示两个光谱越相似。

### 公式

$$
SAM = \cos^{-1} \left( \frac{\sum_{i=1}^{n} a_i b_i}{\sqrt{\sum_{i=1}^{n} a_i^2} \cdot \sqrt{\sum_{i=1}^{n} b_i^2}} \right)
$$

其中， $a_i$和 $b_i$分别是两个光谱向量在第 $i$个波段的反射率值。


